# OpenNMS OpenNMS Service Now Plugin


This plugin was generated by the OPA archetype and is used to forward events to service Now.

The generated plugin contains code examples to demonstrate how to create a:
* Karaf Shell Command (see )
* REST Endpoint (see WebhookHandler & WebhookHandlerImpl)
* Event Configuration Extension (see EventConfExtension)
* Alarm Lifecycle Listener (see AlarmForwarder)

This is the data format for Service Now 

Metodo: POST
Endpoint ServiceNow:  https://minnovosv.service-now.com/api/sespa/comi_opennms/crea_aggiorna_allarmi
Content-type: Application/JSON
Body: row
Credenziali (Basic Auth):
UserId: integrazione.opennms
Psw: password

API ServiceNow

Creazione/Aggiornamento Alert (Da OpenNMS in ServiceNow)


{
"source": "Switch-23-DC1",
"type": "Network Alert",
"severity": "3",
"maintenance": false,
"description": "High packet loss detected on interface Gi1/0/24",
"metric_name": "packet_loss_percentage",
"message_key": "SW23-Gi1/0/24-PLoss",
"resource": "Gi1/0/24",
"node": "SWITCH-23",
"asset": "SW-DC1-0023",
"alert_tags": "datacenter,east-wing,core-network",
"status": "0" //0 = aperto; 1 = chiuso
}


Build and install the plugin into your local Maven repository using:

```
mvn clean install
```


From the OpenNMS Karaf shell:
```
feature:repo-add mvn:org.opennms.plugins.servicenow/karaf-features/0.1.0-SNAPSHOT/xml
feature:install opennms-plugins-opennms-service-now
```


```
cp assembly/kar/target/opennms-opennms-service-now-plugin.kar /opt/opennms/deploy/
feature:install opennms-plugins-opennms-service-now
```

```
bundle:watch *
```


Once installed, the plugin makes the following Karaf shell commands available:
* opennms-opennms-service-now:stats
* opennms-opennms-service-now:push-topology

You can also access the REST endpoint mounted by the plugin at `http://localhost:8980/opennms/rest/opennms-service-now/ping`
